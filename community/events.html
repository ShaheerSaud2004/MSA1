<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - MSA Community</title>
    <link rel="stylesheet" href="css/community.css">
    <link rel="icon" href="../images/logos/msa-logo.svg" type="image/svg+xml">
    <link rel="icon" href="../images/logos/rumsa-favicon.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .create-event-btn {
            background: var(--msa-green);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s;
        }
        .create-event-btn:hover {
            background: var(--msa-green-light);
        }
        .events-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }
        .event-tab {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
        }
        .event-tab.active {
            color: var(--msa-green);
            border-bottom-color: var(--msa-green);
        }
        .events-grid-full {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
        }
        .event-card-full {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            cursor: pointer;
        }
        .event-card-full:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }
        .event-card-full.rsvpd {
            border: 2px solid var(--msa-green);
        }
        .event-header-full {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        .event-date-full {
            text-align: center;
            background: linear-gradient(135deg, var(--msa-green) 0%, var(--msa-green-light) 100%);
            color: white;
            border-radius: 12px;
            padding: 1rem;
            min-width: 80px;
        }
        .event-date-full .date-day {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }
        .event-date-full .date-month {
            font-size: 0.9rem;
            text-transform: uppercase;
            display: block;
            opacity: 0.9;
        }
        .event-info-full {
            flex: 1;
        }
        .event-info-full h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }
        .event-info-full p {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .event-description {
            margin: 1rem 0;
            color: var(--text-dark);
            line-height: 1.6;
        }
        .event-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        .event-attendees-full {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--msa-green);
            font-weight: 500;
        }
        .rsvp-btn-full {
            padding: 0.75rem 2rem;
            background: var(--msa-green);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .rsvp-btn-full:hover {
            background: var(--msa-green-light);
        }
        .rsvp-btn-full.rsvpd {
            background: #28a745;
        }
        .rsvp-btn-full.rsvpd:hover {
            background: #218838;
        }
        .event-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 0.75rem;
        }
        .event-tag {
            background: var(--bg-light);
            color: var(--msa-green);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <nav class="community-nav dashboard-nav">
        <div class="nav-container">
            <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="nav-logo">
                <a href="index.html">
                    <img src="../images/logos/MSA.png" alt="Rutgers MSA Logo" class="logo-img">
                    <span class="logo-text">MSA Community</span>
                </a>
            </div>
            <div class="nav-search">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search events...">
            </div>
            <div class="nav-actions">
                <a href="../index.html" class="nav-link">
                    <i class="fas fa-globe"></i> <span>Website</span>
                </a>
                <div class="notifications-icon">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </div>
                <div class="user-menu">
                    <img src="../images/team/Lad.jpg" alt="Profile" class="user-avatar">
                    <i class="fas fa-chevron-down"></i>
                    <div class="user-dropdown">
                        <a href="profile.html"><i class="fas fa-user"></i> My Profile</a>
                        <a href="settings.html"><i class="fas fa-cog"></i> Settings</a>
                        <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="dashboard-sidebar" id="dashboardSidebar">
            <nav class="sidebar-nav">
                <a href="dashboard.html" class="sidebar-item">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="feed.html" class="sidebar-item">
                    <i class="fas fa-stream"></i>
                    <span>Feed</span>
                </a>
                <a href="events.html" class="sidebar-item active">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Events</span>
                    <span class="badge">5</span>
                </a>
                <a href="messages.html" class="sidebar-item">
                    <i class="fas fa-envelope"></i>
                    <span>Messages</span>
                    <span class="badge">2</span>
                </a>
                <a href="groups.html" class="sidebar-item">
                    <i class="fas fa-users"></i>
                    <span>Groups</span>
                </a>
                <a href="friends.html" class="sidebar-item">
                    <i class="fas fa-user-friends"></i>
                    <span>Friends</span>
                </a>
                <a href="directory.html" class="sidebar-item">
                    <i class="fas fa-address-book"></i>
                    <span>Directory</span>
                </a>
                <a href="resources.html" class="sidebar-item">
                    <i class="fas fa-book"></i>
                    <span>Resources</span>
                </a>
                <a href="study-groups.html" class="sidebar-item">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Study Groups</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="../index.html" class="back-link">
                    <i class="fas fa-arrow-left"></i> Back to Website
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-main">
            <div class="events-header">
                <h1 style="margin: 0; color: var(--text-dark);">Events</h1>
                <button class="create-event-btn" onclick="alert('Create Event feature coming soon!')">
                    <i class="fas fa-plus"></i> Create Event
                </button>
            </div>

            <!-- Event Tabs -->
            <div class="events-tabs">
                <button class="event-tab active" onclick="filterEvents('upcoming')">Upcoming</button>
                <button class="event-tab" onclick="filterEvents('past')">Past Events</button>
                <button class="event-tab" onclick="filterEvents('my-events')">My Events</button>
            </div>

            <!-- Events Grid -->
            <div class="events-grid-full" id="eventsGrid">
                <!-- Event 1 -->
                <div class="event-card-full" data-category="upcoming">
                    <div class="event-header-full">
                        <div class="event-date-full">
                            <span class="date-day">15</span>
                            <span class="date-month">Jan</span>
                        </div>
                        <div class="event-info-full">
                            <h3>MSA Thursday</h3>
                            <p><i class="fas fa-clock"></i> 6:30 PM - 8:00 PM</p>
                            <p><i class="fas fa-map-marker-alt"></i> Student Center, Room 202</p>
                        </div>
                    </div>
                    <div class="event-description">
                        Join us for our weekly MSA Thursday gathering! This week we'll be discussing community service opportunities and how to get involved. Food will be provided!
                    </div>
                    <div class="event-tags">
                        <span class="event-tag">Weekly</span>
                        <span class="event-tag">Discussion</span>
                        <span class="event-tag">Food Provided</span>
                    </div>
                    <div class="event-footer">
                        <div class="event-attendees-full">
                            <i class="fas fa-users"></i> <span class="attendee-count">45</span> attending
                        </div>
                        <button class="rsvp-btn-full" onclick="toggleRSVP(this)">RSVP</button>
                    </div>
                </div>

                <!-- Event 2 -->
                <div class="event-card-full rsvpd" data-category="upcoming my-events">
                    <div class="event-header-full">
                        <div class="event-date-full">
                            <span class="date-day">18</span>
                            <span class="date-month">Jan</span>
                        </div>
                        <div class="event-info-full">
                            <h3>Quran Study Circle</h3>
                            <p><i class="fas fa-clock"></i> 7:00 PM - 8:30 PM</p>
                            <p><i class="fas fa-map-marker-alt"></i> Islamic Center</p>
                        </div>
                    </div>
                    <div class="event-description">
                        Weekly Quran study circle where we read and reflect on verses together. All levels welcome! Bring your mus'haf.
                    </div>
                    <div class="event-tags">
                        <span class="event-tag">Weekly</span>
                        <span class="event-tag">Quran</span>
                        <span class="event-tag">Spiritual</span>
                    </div>
                    <div class="event-footer">
                        <div class="event-attendees-full">
                            <i class="fas fa-users"></i> <span class="attendee-count">32</span> attending
                        </div>
                        <button class="rsvp-btn-full rsvpd" onclick="toggleRSVP(this)">RSVP'd ✓</button>
                    </div>
                </div>

                <!-- Event 3 -->
                <div class="event-card-full" data-category="upcoming">
                    <div class="event-header-full">
                        <div class="event-date-full">
                            <span class="date-day">20</span>
                            <span class="date-month">Jan</span>
                        </div>
                        <div class="event-info-full">
                            <h3>Community Service Day</h3>
                            <p><i class="fas fa-clock"></i> 10:00 AM - 2:00 PM</p>
                            <p><i class="fas fa-map-marker-alt"></i> Local Food Bank</p>
                        </div>
                    </div>
                    <div class="event-description">
                        Join us for a day of community service at the local food bank. We'll be helping sort and distribute food to those in need. Transportation provided!
                    </div>
                    <div class="event-tags">
                        <span class="event-tag">Service</span>
                        <span class="event-tag">Volunteer</span>
                        <span class="event-tag">Transportation</span>
                    </div>
                    <div class="event-footer">
                        <div class="event-attendees-full">
                            <i class="fas fa-users"></i> <span class="attendee-count">28</span> attending
                        </div>
                        <button class="rsvp-btn-full" onclick="toggleRSVP(this)">RSVP</button>
                    </div>
                </div>

                <!-- Event 4 -->
                <div class="event-card-full" data-category="upcoming">
                    <div class="event-header-full">
                        <div class="event-date-full">
                            <span class="date-day">22</span>
                            <span class="date-month">Jan</span>
                        </div>
                        <div class="event-info-full">
                            <h3>Brothers Social Night</h3>
                            <p><i class="fas fa-clock"></i> 7:30 PM - 10:00 PM</p>
                            <p><i class="fas fa-map-marker-alt"></i> Student Center, Main Hall</p>
                        </div>
                    </div>
                    <div class="event-description">
                        Brothers-only social event with games, food, and brotherhood. Come connect with other brothers in the community!
                    </div>
                    <div class="event-tags">
                        <span class="event-tag">Social</span>
                        <span class="event-tag">Brothers Only</span>
                        <span class="event-tag">Games</span>
                    </div>
                    <div class="event-footer">
                        <div class="event-attendees-full">
                            <i class="fas fa-users"></i> <span class="attendee-count">67</span> attending
                        </div>
                        <button class="rsvp-btn-full" onclick="toggleRSVP(this)">RSVP</button>
                    </div>
                </div>

                <!-- Event 5 -->
                <div class="event-card-full" data-category="upcoming">
                    <div class="event-header-full">
                        <div class="event-date-full">
                            <span class="date-day">25</span>
                            <span class="date-month">Jan</span>
                        </div>
                        <div class="event-info-full">
                            <h3>Islamic Lecture Series</h3>
                            <p><i class="fas fa-clock"></i> 6:00 PM - 7:30 PM</p>
                            <p><i class="fas fa-map-marker-alt"></i> Lecture Hall 101</p>
                        </div>
                    </div>
                    <div class="event-description">
                        Guest speaker Imam Ahmed will be discussing "Building Character in Modern Times". Open to all community members.
                    </div>
                    <div class="event-tags">
                        <span class="event-tag">Lecture</span>
                        <span class="event-tag">Education</span>
                        <span class="event-tag">Open to All</span>
                    </div>
                    <div class="event-footer">
                        <div class="event-attendees-full">
                            <i class="fas fa-users"></i> <span class="attendee-count">89</span> attending
                        </div>
                        <button class="rsvp-btn-full" onclick="toggleRSVP(this)">RSVP</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/community.js"></script>
    <script>
        async function toggleRSVP(btn) {
            // Check if user is logged in
            const user = getCurrentUser();
            if (!user) {
                alert('Please log in to RSVP!');
                window.location.href = 'index.html';
                return;
            }
            
            const card = btn.closest('.event-card-full');
            const countSpan = card.querySelector('.attendee-count');
            const eventName = card.querySelector('h3').textContent;
            let count = parseInt(countSpan.textContent);
            
            if (btn.classList.contains('rsvpd')) {
                btn.classList.remove('rsvpd');
                card.classList.remove('rsvpd');
                btn.textContent = 'RSVP';
                count--;
                // Track cancellation
                await trackEventRSVP(eventName, 'cancel');
            } else {
                btn.classList.add('rsvpd');
                card.classList.add('rsvpd');
                btn.textContent = 'RSVP\'d ✓';
                count++;
                // Track RSVP
                await trackEventRSVP(eventName, 'rsvp');
            }
            countSpan.textContent = count;
        }
        
        // Get current user helper
        function getCurrentUser() {
            const user = localStorage.getItem('msa_user');
            if (user) {
                return JSON.parse(user);
            }
            return null;
        }
        
        // Track event RSVP
        async function trackEventRSVP(eventName, action) {
            try {
                await fetch('/api/track-click', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        section: 'events',
                        event: eventName,
                        album: action,
                        timestamp: new Date().toISOString(),
                        userAgent: navigator.userAgent
                    })
                });
            } catch (error) {
                console.error('Error tracking RSVP:', error);
            }
        }
        
        function filterEvents(filter) {
            // Update active tab
            document.querySelectorAll('.event-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter events
            const events = document.querySelectorAll('.event-card-full');
            events.forEach(event => {
                const categories = event.getAttribute('data-category');
                if (categories.includes(filter)) {
                    event.style.display = 'block';
                } else {
                    event.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>

