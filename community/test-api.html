<!DOCTYPE html>
<html>
<head>
    <title>Test API Connection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        button {
            background: #2c5530;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #4a7c59;
        }
    </style>
</head>
<body>
    <h1>API Connection Test</h1>
    <p>This page tests if the authentication API endpoints are accessible.</p>
    
    <button onclick="testAll()">Test All Endpoints</button>
    <button onclick="testLogin()">Test Login Endpoint</button>
    <button onclick="testSignup()">Test Signup Endpoint</button>
    
    <div id="results"></div>

    <script>
        const resultsDiv = document.getElementById('results');
        
        function addResult(message, isSuccess) {
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.textContent = message;
            resultsDiv.appendChild(div);
        }
        
        function clearResults() {
            resultsDiv.innerHTML = '';
        }
        
        async function testEndpoint(name, url, method = 'GET', body = null) {
            try {
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    }
                };
                
                if (body) {
                    options.body = JSON.stringify(body);
                }
                
                const response = await fetch(url, options);
                const text = await response.text();
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch {
                    data = { raw: text };
                }
                
                if (response.ok || response.status < 500) {
                    addResult(`✅ ${name}: OK (Status: ${response.status})`, true);
                    console.log(`${name} response:`, data);
                    return true;
                } else {
                    addResult(`❌ ${name}: Error (Status: ${response.status}) - ${JSON.stringify(data)}`, false);
                    return false;
                }
            } catch (error) {
                addResult(`❌ ${name}: Network Error - ${error.message}`, false);
                return false;
            }
        }
        
        async function testLogin() {
            clearResults();
            addResult('Testing Login Endpoint...', true);
            
            const urls = [
                '../api/auth/login',
                '/api/auth/login',
                'api/auth/login'
            ];
            
            for (const url of urls) {
                await testEndpoint(`Login (${url})`, url, 'POST', {
                    email: 'test@test.com',
                    password: 'test1234'
                });
            }
        }
        
        async function testSignup() {
            clearResults();
            addResult('Testing Signup Endpoint...', true);
            
            const urls = [
                '../api/auth/signup',
                '/api/auth/signup',
                'api/auth/signup'
            ];
            
            for (const url of urls) {
                await testEndpoint(`Signup (${url})`, url, 'POST', {
                    firstName: 'Test',
                    lastName: 'User',
                    email: `test${Date.now()}@test.com`,
                    password: 'test1234',
                    year: 'freshman',
                    major: 'Test'
                });
            }
        }
        
        async function testAll() {
            clearResults();
            addResult('Testing all endpoints...', true);
            await testLogin();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testSignup();
        }
    </script>
</body>
</html>

